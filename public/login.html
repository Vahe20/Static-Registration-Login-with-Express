<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Login</title>
		<link rel="stylesheet" href="css/login.css" />
	</head>
	<body>
		<div class="login-container">
			<h1>Login</h1>
			<form method="POST" action="/api/login">
				<div class="form-group">
					<label for="email">Email:</label>
					<input type="email" id="email" name="email" required />
				</div>
				<div class="form-group">
					<label for="password">Password:</label>
					<input
						type="password"
						id="password"
						name="password"
						required
					/>
				</div>
				<button type="submit">Login</button>
			</form>

			<p>
				Don't have an account?
				<a href="register.html">Register here</a>
			</p>
		</div>

		<script>
			const form = document.querySelector("form");
			form.addEventListener("submit", async e => {
				e.preventDefault();

				const formData = new FormData(form);
				const data = {
					email: formData.get("email"),
					password: formData.get("password"),
				};

				try {
					const response = await fetch("/api/login", {
						method: "POST",
						headers: {
							"Content-Type": "application/json",
						},
						body: JSON.stringify(data),
					})
						.then(res => res.json())
						.then(data => {
							if (data.ok) {
								console.log(data);
								alert("Login successful!");
								localStorage.setItem("token", data.token);
								window.location.href = "/profile.html";
							} else {
								alert("Login failed: " + data.message);
							}
						});
				} catch (error) {
					console.error("Error:", error);
					alert("An error occurred during login.");
				}
			});
		</script>
	</body>
</html>
